<html></html>
  <head>
    <title>Class work | Home Work | test server change</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="tailwindcss.js"></script>
    <script src="vue.js"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              'white': {
              DEFAULT: '#E6E6E6',
              50: '#FFFFFF',
              100: '#FFFFFF',
              200: '#FFFFFF',
              300: '#FFFFFF',
              400: '#FFFFFF',
              500: '#E6E6E6',
              600: '#D1D1D1',
              700: '#BDBDBD',
              800: '#A8A8A8',
              900: '#949494',
              950: '#8A8A8A'
            },
            'blue': {
              DEFAULT: '#3B82F6',
              50: '#BFD6FC',
              100: '#B0CDFB',
              200: '#93BAFA',
              300: '#76A7F9',
              400: '#5895F7',
              500: '#3B82F6',
              600: '#0B63F3',
              700: '#094FC2',
              800: '#073B91',
              900: '#042761',
              950: '#031D48'
            },
            'pink': {
              DEFAULT: '#EC4899',
              50: '#FBDAEA',
              100: '#F9C9E0',
              200: '#F6A9CE',
              300: '#F389BC',
              400: '#EF68AB',
              500: '#EC4899',
              600: '#E4187D',
              700: '#B11262',
              800: '#7F0D46',
              900: '#4C082A',
              950: '#32051C'
            },
            'gray': {
              DEFAULT: '#6B7280',
              50: '#B4B8C0',
              100: '#ACB0BA',
              200: '#9BA1AC',
              300: '#8B919E',
              400: '#7A8190',
              500: '#6B7280',
              600: '#565C67',
              700: '#41454E',
              800: '#2C2F35',
              900: '#17191C',
              950: '#0D0E0F'
            },
          }
        }
      }
    }
  </script>
</head>
  </head>

  <body id="app" class="bg-blue-200 flex flex-col text-blue-600 h-svh">
    <div class="bg-red-200 p-8">
      <h1 class="text-blue-700 text-4xl">{{ message }}</h1>
      <button @click="changesMsg">Change me</button>
    </div>
    <div id="container" class="flex grow flex-column">
      <div class="w-60 box-border p-6 bg-pink-50">
        <h1 class="text-blue-500 text-2xl">Sidebar</h1>
      </div>
      <div id="mainBox" class="flex w-full gap-2">
        <div
          class="bg-pink-50 text-black-500 p-4 rounded-md shadow-2xl slideDown"
          style="width: 38%"
        >
          <form
            id="ecommerceForm"
            onsubmit="event.preventDefault();"
            style="display: flex; flex-direction: column; gap: 4px"
          >
            <label>Checkout Form( {{computedTotalCart}} )</label>
            <input
              type="text"
              name="first_name"
             required
             v-model="checkoutForm.first_name"
              id="first_name"
              placeholder="Enter you first_name"
            />
            <span style="color: red" hidden id="taskErrorField-first_name"
              >This field is required</span
            >
            <input
              type="text"
              name="last_name"
               required
               v-model="checkoutForm.last_name"
              id="last_name"
              placeholder="Enter you last_name"
            />
            <span style="color: red" hidden id="taskErrorField-last_name"
              >This field is required</span
            >
            <input
              type="tel"
              name="number"
              required
              id="number"
              v-model="checkoutForm.phone_number"
              placeholder="Enter you phone_number"
            />
            <span style="color: red" hidden id="taskErrorField-number"
              >This field is required</span
            >
            <textarea
              id="address"
              name="address"
              v-model="checkoutForm.address"
              placeholder="enter your full address"
            ></textarea>
            <span style="color: red" hidden id="taskErrorField-address"
              >This field is required</span
            >
            <input
              type="email"
              name="email"
              required
              v-model="checkoutForm.email"
              id="email"
              placeholder="Enter you email"
            />
            <span style="color: red" hidden id="taskErrorField-email"
              >This field is required</span
            >
            <input
              type="text"
              name="postal_code"
              v-model="checkoutForm.postal_code"
              required
              id="postal_code"
              placeholder="Enter you postal_code"
            />
            <span style="color: red" hidden id="taskErrorField-postal_code"
              >This field is required</span
            >
            <select id="city" name="city" 
            v-model="checkoutForm.city"
            >
              <option selected>Karachi</option>
              <option>Lahore</option>
              <option>Islamabed</option>
              <option>Peshawar</option>
              <option>Queta</option>
            </select>
            <span style="color: red" hidden id="taskErrorField-city"
              >This field is required</span
            >
            <select id="country" name="country"
            v-model="checkoutForm.country" >
              <option selected>Pakistan</option>
            </select>
            <span style="color: red" hidden id="taskErrorField-country"
              >This field is required</span
            >
            <div>
              <label class="flex gap-2 blue-700">
               <input 
                  type="radio"
                  name="task"
                  v-model="checkoutForm.payment_method"
                  required
                  id="payment_method"
                  checked
                  placeholder="Enter you payment_method"
                />
                Cash on Delivery
              </label>
              <label class="flex gap-2">
                <input
                  type="radio"
                  v-model="checkoutForm.payment_method"
                  name="task"
                  required
                  id="payment_method"
                  placeholder="Enter you payment_method"
                />
                Online Payment
              </label>
            </div>
            <button
              type="button"
              @click="sumbitCheckout()"
              id="submitBtn"
              class="bg-pinl-400 text-white-200 p-2 border-0 hover:bg-pink-700 active:bg-pink-700 rounded-md"
            >
              Checkout
            </button>
          </form>
          <div>
            <label>Cart Details</label>
            <div
              id="boxList"
              style="
                width: 80%;
                display: flex;
                flex-direction: column;
                gap: 4px;
              "
              class="grid-item slideDown"
            >
            <div class="box bg-red-50 font-medium text-blue-900">
              <div
                style="
                  padding-left: 10px;
                  border-radius: 50%;
                  padding-right: 10px;
                  display: flex;
                  justify-content: space-between;
                  align-items: center;
                "
                v-for="(x, index) in checkoutForm.cart_details"
              >
                <p>{{ x.name}}</p>
                <div
                  class="text-seaGreen-500"
                  v-if="x.discounted_price < x.price"
                >
                  <span class="text-red-600 line-through" :data-id="x.id">
                    {{x.price}}
                  </span>
                  {{x.discounted_price}}
                </div>
                <div class="text-seaGreen-500" v-else>{{x.price}}</div>
                <div>{{'Quantity '+ x.quantity }}</div>
                <div>
                  <button class="text-red-500" @click="removeItemCart(x.id)">
                    X
                  </button>
                </div>
              </div>
            </div>
            </div>
          </div>
        </div>
        <div id="main" class="p-4 grid grow border-box grid-cols-2 gap-4">
          <div
            class="bg-white-500 text-black-500 p-4 rounded-md shadow-2xl slideDown"
            v-for="(x, index) in products"
          >
            <h1 class="font-bold">{{ x.name }}</h1>
            <p class="font-medium">{{ x.description }}</p>

            <div class="text-seaGreen-500" v-if="x.discounted_price < x.price">
              <span class="text-red-600 line-through">{{ x.price }}</span>
              {{ x.discounted_price }}
            </div>
            <div class="text-seaGreen-500" v-else>{{ x.price }}</div>
            <div class="">
              <input type="number" :id='"qty"+ x.id' />
              <button
                class="bg-blue-400 text-white-200 font-medium rounded-lg w-32 py-1"
                @click="addToCart(x.id)"
              >
                Add to Cart
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
  <script>
    const { createApp, ref,onMounted,computed } = Vue;

    createApp({
      setup() {
        const message = ref("Hello vue!");
        const initialCheckoutForm = {
          first_name: "",
          last_name: "",
          phone_number: 0,
          address: "",
          email: "",
          postal_code: "",
          city: "",
          country: "",
          payment_method: "",
          shipping_details: {
            address: "",
            city: "",
            postal_code: "",
            country: "",
            phone_number: "",
            reciever_name: "",
          },
          total_amount: "",
          cart_details: [],
        };
        const checkoutForm = ref({
          first_name: "",
          last_name: "",
          phone_number: 0,
          address: "",
          email: "",
          postal_code: "",
          city: "",
          country: "",
          payment_method: "",
          shipping_details: {
            address: "",
            city: "",
            postal_code: "",
            country: "",
            phone_number: "",
            reciever_name: "",
          },
          total_amount: "",
          cart_details: [],
        });
        const products = [
          {
            id: 1,
            name: "water bottle",
            description: "color: blue size: large",
            price: 100,
            discounted_price: 99,
          },
          {
            id: 2,
            name: "mouse",
            description: "wired usb port",
            price: 250,
            discounted_price: 199,
          },
          {
            id: 3,
            name: "watch",
            description: "color: black, watch type: smart, brand: apple",
            price: 5000,
            discounted_price: 4999,
          },
          {
            id: 4,
            name: "infinix s23",
            description: "color blue, storage: 120gb ram: 2gb display: 6x4",
            price: 25000,
            discounted_price: 24999,
          },
          {
            id: 5,
            name: "shoes",
            description: "size: 8, color blue, type: sports wear",
            price: 3000,
            discounted_price: 3000,
          },
        ];


        onMounted(()=>{
          alert("let see");
        });

        const computedTotalCart = computed(() => {
          var total = checkoutForm.value.cart_details.reduce((accumulator, currentValue) => {
            var currentPrice = currentValue.discounted_price < currentValue.price ? currentValue.discounted_price : currentValue.price
            return accumulator + currentPrice * currentValue.quantity
          }, 0);
          return total;
        });

        const validateFields = () => {
          var basicFields = [
            "first_name",
            "last_name",
            "address",
            "postal_code",
          ];
          const basicValidation = () => {
            var checkValidation = true;
            basicFields.forEach((x) => {
              if (
                checkoutForm(x).value == "" ||
                checkoutForm(x).value == null
              ) {
                checkValidation = false;
                document.getElementById("taskErrorField-" + x).hidden = false;
              } else {
                document.getElementById("taskErrorField-" + x).hidden = true;
              }
            });
            return checkValidation;
          };
          var testBasicValidation = basicValidation();
          if (!testBasicValidation) {
            return false;
          }
          const validatePhoneNumber = (phoneNumber) => {
            const regex = /^(\+92|92|033|03)[ -]*\d{3}[ -]*\d{7}$/;
            return regex.test(phoneNumber);
          };
          if (!validatePhoneNumber(checkoutForm.value.phone_number)) {
            document.getElementById("taskErrorField-number").hidden = false;
            return false;
          } else {
            document.getElementById("taskErrorField-number").hidden = true;
          }
          const validateEmail = (email) => {
            const regex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
            return regex.test(email);
          };
          if (!validateEmail(checkoutForm.value.email)) {
            document.getElementById("taskErrorField-email").hidden = false;
            return false;
          } else {
            document.getElementById("taskErrorField-email").hidden = true;
          }
          if (checkoutForm.value.cart_details.length == 0) {
            alert("Please add items in your cart first");
            return false;
          }
          return true;
        };

        const sumbitCheckout = () => {
          const checkForm = validateFields();
          if (checkForm) {
            alert("Thank you for shopping with us");
            checkoutForm.value = { ...initialCheckoutForm };
            checkoutForm.value.cart_details = [];
            document.getElementById("ecommerceForm").reset();
          }
        };

        const addToCart = (product) => {
          debugger;
          var currentProduct = products.find((x) => {
            return x.id == product;
          });
          // ternary operator
          //   var ternaryOpt = 5 > 10 || 5 < 10 ? 5 : 10;
          var currentQty =
            document.getElementById("qty" + product).value == "" ||
            document.getElementById("qty" + product).value == null
              ? 1
              : document.getElementById("qty" + product).value;
          cartExistIndex = checkoutForm.value.cart_details.findIndex((x) => {
            return x.id == product;
          });
          if (cartExistIndex != -1) {
            checkoutForm.value.cart_details[cartExistIndex].quantity +=
              parseInt(currentQty);
          } else {
            var cartItem = {
              ...currentProduct,
              quantity: currentQty,
            };

            checkoutForm.value.cart_details.push(cartItem);
          }
          document.getElementById("qty" + product).value = "";
        };

        function removeItemCart(id) {
          var proIndex = checkoutForm.value.cart_details.findIndex((x) => {
            return x.id == id;
          });
          checkoutForm.value.cart_details.splice(proIndex, 1);
        };


        const changesMsg = () => {
          message.value = "I am change now";
        };

        return {
          message,
          initialCheckoutForm,
          checkoutForm,
          addToCart,
          removeItemCart,
          products,
          sumbitCheckout,
          computedTotalCart,
          changesMsg,
        };
      },
    }).mount("#app");
  </script>
</html>